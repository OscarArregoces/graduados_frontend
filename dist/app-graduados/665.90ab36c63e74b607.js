"use strict";(self.webpackChunkAppTuristica=self.webpackChunkAppTuristica||[]).push([[665],{1009:(Se,X,D)=>{D.d(X,{S:()=>q});var N=D(529),K=D(8274);let q=(()=>{class U{constructor(T){this.http=T}get(T,I){let y={headers:new N.WM({"Content-Type":"application/json",Authorization:`Bearer ${I}`})};return this.http.get(T,y)}post(T,I,y){let L={headers:new N.WM({"Content-Type":"application/json",Authorization:`Bearer ${y}`})};return this.http.post(T,I,L)}put(T,I,y){let L={headers:new N.WM({"Content-Type":"application/json",Authorization:`Bearer ${y}`})};return this.http.put(T,I,L)}delete(T,I,y){let L={headers:new N.WM({"Content-Type":"application/json",Authorization:`Bearer ${I}`}),body:y};return this.http.delete(T,L)}}return U.\u0275fac=function(T){return new(T||U)(K.LFG(N.eN))},U.\u0275prov=K.Yz7({token:U,factory:U.\u0275fac,providedIn:"root"}),U})()},659:(Se,X,D)=>{function y(n,t,e,o){return new(e||(e=Promise))(function(r,s){function c(d){try{a(o.next(d))}catch(v){s(v)}}function h(d){try{a(o.throw(d))}catch(v){s(v)}}function a(d){d.done?r(d.value):function i(r){return r instanceof e?r:new e(function(s){s(r)})}(d.value).then(c,h)}a((o=o.apply(n,t||[])).next())})}D.d(X,{d$:()=>Pe,Mk:()=>Me,Lq:()=>b});var ve=D(7579);class O extends ve.x{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(t){const{hasError:e,_hasValue:o,_value:i,thrownError:r,isStopped:s,_isComplete:c}=this;e?t.error(r):(s||c)&&(o&&t.next(i),t.complete())}next(t){this.isStopped||(this._value=t,this._hasValue=!0)}complete(){const{_hasValue:t,_value:e,_isComplete:o}=this;o||(this._isComplete=!0,t&&super.next(e),super.complete())}}var de=D(1135),C=D(8274);const Ee=["video"],ye=["canvas"],Re=["resultsPanel"],J="assets/wasm/index.js",B="https://cdn.jsdelivr.net/npm/ngx-scanner-qrcode@1.5.7/wasm/index.js",he={audio:!1,video:!0},Z={lineWidth:1,strokeStyle:"green",fillStyle:"#55f02880"},ee={font:"15px serif",strokeStyle:"#fff0",fillStyle:"#ff0000"},F={src:"",fps:30,vibrate:300,decode:"utf-8",isBeep:!0,constraints:he,canvasStyles:[Z,ee]};var W=()=>"zbarWasm"in window;const u=(n,t,e=null)=>{e?n.error(e):n.next(t),n.complete()},te=(n=!1)=>{if(!1===n)return;const t=new Audio("data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV");t.oncanplaythrough=()=>{const e=t.play();e&&e.catch(o=>{})}},R=(n,t)=>{const e=t.split(".");for(let o=0;o<e.length;o++){let i=e[o];if(!n||!n.hasOwnProperty(i))return!1;n=n[i]}return!0},ue=(n,t,e,o)=>{let i,r,s=t.width,c=t.height,h=s/c,a=parseInt(getComputedStyle(t).width),d=parseInt(getComputedStyle(t).height),v=a/d;e.innerHTML="",h>v?(i=a/s,r=a/h/c):(r=d/c,i=d*h/s);for(let m=0;m<n.length;m++){const S=n[m];let _=document.createElement("canvas"),w=_.getContext("2d",{willReadFrequently:!0}),g={},p=[],E=[],x=0,j=0;if(2===o.length&&o[1].font){let f=o[1].font.replace(/[^0-9]/g,"");/[0-9]/g.test(f)&&(x=parseFloat(f),j=(i||1)*x,Number.isNaN(j)&&(j=x))}const G=S.points;for(let f=0;f<G.length;f++){const z=R(G,`${f}.x`)?G[f].x:0,$=R(G,`${f}.y`)?G[f].y:0;g[`x${f+1}`]=z,g[`y${f+1}`]=$,p.push(z),E.push($)}let oe=Math.max(...p),P=Math.min(...p),re=Math.max(...E),V=Math.min(...E);_.setAttribute("class","qrcode-polygon"),h>v?(_.style.top=V*r+.5*(d-a/h)+"px",_.style.left=P*i+"px",_.width=(oe-P)*i,_.height=(re-V)*i):(_.style.top=V*r+"px",_.style.left=P*i+.5*(a-d*h)+"px",_.width=(oe-P)*r,_.height=(re-V)*r);for(const f in o[0])w[f]=o[0][f];const se=[];for(let f=0;f<p.length;f++)se.push((g[`x${f+1}`]-P)*r),se.push((g[`y${f+1}`]-V)*i);const H=se.slice(0);for(w.beginPath(),w.moveTo(H.shift(),H.shift());H.length;)w.lineTo(H.shift(),H.shift());if(w.closePath(),w.fill(),w.stroke(),x){const f=document.createElement("div");f.setAttribute("class","qrcode-tooltip-temp"),f.innerText=S.value,f.style.maxWidth=(s>window.innerWidth?.9*window.innerWidth:s)+"px",f.style.borderRadius=`clamp(1px, ${i*x-10}px, 3px)`,f.style.paddingBlock=`clamp(1px, ${i*x-10}px, 3px)`,f.style.paddingInline=`clamp(2.5px, ${i*x-6}px, 10px)`;const z=`<svg xmlns="http://www.w3.org/2000/svg" width="${j}" height="${j}" viewBox="0 0 512 512"><rect x="128" y="128" width="336" height="336" rx="57" ry="57"></rect><path d="M383.5,128l.5-24a56.16,56.16,0,0,0-56-56H112a64.19,64.19,0,0,0-64,64V328a56.16,56.16,0,0,0,56,56h24"></path></svg>`,$=(new DOMParser).parseFromString(z,"application/xml"),ae=f.ownerDocument.importNode($.documentElement,!0);ae.style.marginLeft=`clamp(1px, ${i*x-10}px, 3px)`,f.appendChild(ae),ae.addEventListener("click",()=>window.navigator.clipboard.writeText(S.value)),f.addEventListener("click",()=>window.navigator.clipboard.writeText(S.value));const M=document.createElement("div");M.setAttribute("class","qrcode-tooltip"),M.appendChild(f),r=d/c,i=d*h/s,M.style.fontSize=i*x+"px",M.style.top=V*r+"px",M.style.left=P*i+.5*(a-d*h)+"px",M.style.width=(oe-P)*r+"px",M.style.height=(re-V)*r+"px";const k=document.createElement("span");if(k.innerText=S.value,k.style.top=V*r+-20*r+"px",k.style.left=P*i+.5*(a-d*h)+"px",k.style.fontSize=i*x+"px",2==o.length&&o[1]&&o[1].font){const Ue=o[1].font.split(" ")[1];k.style.fontFamily=Ue,k.style.color=o[1].fillStyle}e&&(e.appendChild(M),e.appendChild(k))}e&&e.appendChild(_)}},fe=(n,t)=>new Promise((e,o)=>n.toBlob(i=>e(i),t)),pe=(n=[],t,e,o,i=new O)=>(Ae(n,e,o).then(r=>{Promise.all(Object.assign([],n).map(s=>((n,t)=>{let e=R(t,"decode")?t.decode:F.decode,o=R(t,"canvasStyles")&&2===t.canvasStyles.length?t.canvasStyles:[Z,ee],i=R(t,"isBeep")?t.isBeep:F.isBeep;return new Promise((r,s)=>{const c=new FileReader;c.onload=()=>{const h={name:n.name,file:n,url:URL.createObjectURL(n)},a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=()=>y(void 0,void 0,void 0,function*(){const d=document.createElement("canvas");d.width=a.naturalWidth||a.width,d.height=a.naturalHeight||a.height;const v=d.getContext("2d");v.drawImage(a,0,0,d.width,d.height);const m=v.getImageData(0,0,d.width,d.height);if(W()){const S=yield zbarWasm.scanImageData(m);if(S&&S.length){S.forEach(p=>p.value=p.decode(e&&e.toLocaleLowerCase())),((n,t,e)=>{let o=t.getContext("2d",{willReadFrequently:!0});for(let i=0;i<n.length;i++){const r=n[i];let s={},c=[],h=[],a=0;if(2===e.length){const g=e[1]&&e[1].font&&e[1].font.split(" ")[0];let p=g&&g.replace(/[^0-9]/g,"");p&&/[0-9]/g.test(p)&&(a=parseFloat(p))}const d=r.points;for(let g=0;g<d.length;g++){const p=R(d,`${g}.x`)?d[g].x:0,E=R(d,`${g}.y`)?d[g].y:0;s[`x${g+1}`]=p,s[`y${g+1}`]=E,c.push(p),h.push(E)}let v=Math.min(...c),m=Math.min(...h);const S=()=>{for(const E in e[0])o[E]=e[0][E];const g=[];for(let E=0;E<c.length;E++)g.push(s[`x${E+1}`]),g.push(s[`y${E+1}`]);const p=g.slice(0);for(o.beginPath(),o.moveTo(p.shift(),p.shift());p.length;)o.lineTo(p.shift(),p.shift());o.closePath(),o.fill(),o.stroke()};let _=document.createElement("canvas");const w=()=>{if(2===e.length){const g=e[1]&&e[1].font&&e[1].font.split(" ")[1];_.height=t.height,_.width=t.width;let p=_.getContext("2d",{willReadFrequently:!0});p.font=a+"px "+g;for(const E in e[1])p[E]=e[1][E];Ne(p,r.value,v,m-5)}};S(),w(),o.drawImage(_,0,0)}})(S,d,o);const _=yield fe(d),w=URL.createObjectURL(_);r(Object.assign({},h,{data:S,url:w,canvas:d,file:(p=_,E=h.name,new File([p],E,{lastModified:(new Date).getTime(),type:p.type}))})),te(i)}else r(Object.assign({},h,{data:S,canvas:d}))}var p,E}),a.src=h.url},c.onerror=h=>s(h),c.readAsDataURL(n)})})(s,t))).then(s=>{u(i,s)}).catch(s=>u(i,null,s))}),i),Ne=(n,t,e,o)=>{let i=1.2*n.measureText("M").width,r=t.split("\n");for(var s=0;s<r.length;++s)n.fillText(r[s],e,o),n.strokeText(r[s],e,o),o+=i},Ae=(n,t=.5,e="image/jpeg")=>y(void 0,void 0,void 0,function*(){if(!n.length||1===t)return n;const o=r=>y(this,void 0,void 0,function*(){const s=yield createImageBitmap(r),c=document.createElement("canvas");c.width=s.width,c.height=s.height,c.getContext("2d").drawImage(s,0,0);const a=yield new Promise(d=>c.toBlob(d,e,t));return new File([a],r.name,{type:a.type})}),i=new DataTransfer;return yield(()=>y(this,void 0,void 0,function*(){for(const r of n){if(!r.type.startsWith("image")){i.items.add(r);continue}const s=yield o(r);i.items.add(s)}}))(),i.files}),me=n=>{Object.assign([],n.childNodes).forEach(t=>n.removeChild(t))},ne=(n,t)=>{n.style.width=t.offsetWidth+"px",n.style.height=t.offsetHeight+"px"},_e=n=>{n&&De()&&window&&window.navigator&&window.navigator.vibrate(n)},De=()=>{const n=navigator.userAgent||navigator.vendor||window.opera;return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(n)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(n.substr(0,4))||/^((?!chrome|android).)*safari/i.test(n))};class b{loadFiles(t=[],e,o){const i=new O;return Ae(t,e,o).then(r=>{Promise.all(Object.assign([],t).map(s=>this.readAsDataURL(s))).then(s=>u(i,s)).catch(s=>u(i,null,s))}),i}loadFilesToScan(t=[],e,o,i){return pe(t,e,o,i)}readAsDataURL(t){return new Promise((e,o)=>{const i=new FileReader;i.onload=()=>{const r={name:t.name,file:t,url:URL.createObjectURL(t)};e(r)},i.onerror=r=>o(r),i.readAsDataURL(t)})}}b.\u0275fac=function(t){return new(t||b)},b.\u0275prov=C.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b.ngInjectableDef=(0,C.Ez6)({factory:function(){return new b},token:b,providedIn:"root"});let Pe=(()=>{class n{constructor(e,o){this.renderer=e,this.elementRef=o,this.event=new C.vpe,this.src=F.src,this.fps=F.fps,this.vibrate=F.vibrate,this.decode=F.decode,this.isBeep=F.isBeep,this.config=F,this.constraints=F.constraints,this.canvasStyles=[Z,ee],this.isStart=!1,this.isPause=!1,this.isLoading=!1,this.isTorch=!1,this.data=new de.X([]),this.devices=new de.X([]),this.deviceIndexActive=0,this.dataForResize=[],this.ready=new O,this.STATUS={startON:()=>this.isStart=!0,pauseON:()=>this.isPause=!0,loadingON:()=>this.isLoading=!0,startOFF:()=>this.isStart=!1,pauseOFF:()=>this.isPause=!1,loadingOFF:()=>this.isLoading=!1,torchOFF:()=>this.isTorch=!1}}ngOnInit(){this.overrideConfig(),((n=new O,t)=>{let e=0;const o=(i=!1)=>{const r=()=>{let h;try{const a=()=>{clearTimeout(h),W()?setTimeout(()=>u(n,!0)):h=setTimeout(()=>a())};setTimeout(()=>a()),setTimeout(()=>clearTimeout(h),3e3)}catch{clearTimeout(h)}},s=document.querySelectorAll(`script[src="${B}"]`),c=document.querySelectorAll('script[src="https://cdn.jsdelivr.net/npm/ngx-scanner-qrcode@latest/wasm/index.js"]');if(s.length||c.length)r();else{const h=document.querySelectorAll(`script[src="${J}"]`);if(1===h.length)r();else if(h.forEach(a=>a.remove()),t){const a=t.createElement("script");t.setAttribute(a,"src",i?B:J),t.setAttribute(a,"type","text/javascript"),t.setAttribute(a,"async",""),t.appendChild(document.head,a),a.onload=()=>r(),a.onerror=()=>{e<2?(document.head.removeChild(a),o(!0)):u(n,!1,B)},e+=1}else{const a=document.createElement("script");a.setAttribute("src",i?B:J),a.setAttribute("type","text/javascript"),a.setAttribute("async",""),document.head.appendChild(a),a.onload=()=>r(),a.onerror=()=>{e<2?(document.head.removeChild(a),o(!0)):u(n,!1,B)},e+=1}}};return o(),n})(this.ready,this.renderer).subscribe(()=>{this.src&&this.loadImage(this.src),this.resize()})}start(e){const o=new O;return this.isStart?u(o,!1):this.safariWebRTC(o,e),o}stop(){this.STATUS.pauseOFF(),this.STATUS.startOFF(),this.STATUS.torchOFF(),this.STATUS.loadingOFF();const e=new O;try{clearTimeout(this.rAF_ID),this.video.nativeElement.srcObject.getTracks().forEach(o=>{o.stop(),u(e,!0)}),this.dataForResize=[],(n=>{n.getContext("2d",{willReadFrequently:!0}).clearRect(0,0,n.width,n.height)})(this.canvas.nativeElement),me(this.resultsPanel.nativeElement)}catch(o){u(e,!1,o)}return e}play(){const e=new O;return this.isPause?(this.video.nativeElement.play(),this.STATUS.pauseOFF(),this.requestAnimationFrame(100),u(e,!0)):u(e,!1),e}pause(){const e=new O;return this.isStart?(clearTimeout(this.rAF_ID),this.video.nativeElement.pause(),this.STATUS.pauseON(),u(e,!0)):u(e,!1),e}playDevice(e,o=new O){const i=this.getConstraints();switch(!0){case"null"===e||"undefined"===e||!e:stop(),this.stop(),u(o,!1);break;case e&&(!this.isStart||!i||i.deviceId!==e):stop(),this.stop(),this.STATUS.loadingON(),this.deviceIndexActive=this.devices.value.findIndex(c=>c.deviceId===e);const s=Object.assign({},this.constraints,{audio:!1,video:Object.assign({deviceId:e},this.constraints.video)});navigator.mediaDevices.getUserMedia(s).then(c=>{this.video.nativeElement.srcObject=c,this.video.nativeElement.onloadedmetadata=()=>{this.video.nativeElement.play(),this.requestAnimationFrame(),u(o,!0),this.STATUS.startON(),this.STATUS.loadingOFF()}}).catch(c=>{this.eventEmit(!1),u(o,!1,c),this.STATUS.startOFF(),this.STATUS.loadingOFF()});break;default:u(o,!1),this.STATUS.loadingOFF()}return o}loadImage(e){const o=new O;this.STATUS.startOFF(),this.STATUS.loadingON();const i=new Image;return i.setAttribute("crossOrigin","anonymous"),i.onload=()=>{W()&&this.drawImage(i,r=>{u(o,r),this.STATUS.startOFF(),this.STATUS.loadingOFF()})},i.src=e,o}torcher(){const e=this.applyConstraints({advanced:[{torch:this.isTorch}]});return e.subscribe(()=>!1,()=>this.isTorch=!this.isTorch),e}applyConstraints(e,o=0){const i=new O;if(this.isStart){const r=this.video.nativeElement.srcObject;if(null===o&&void 0===o&&Number.isNaN(o))u(i,!1,"Please check again deviceIndex");else{const s=r.getVideoTracks()[o];new window.ImageCapture(s).getPhotoCapabilities().then(()=>y(this,void 0,void 0,function*(){yield s.applyConstraints(e),ne(this.video.nativeElement,this.canvas.nativeElement),u(i,this.getConstraints())})).catch(h=>{switch(h&&h.name){case"NotFoundError":case"DevicesNotFoundError":u(i,!1,"Required track is missing");break;case"NotReadableError":case"TrackStartError":u(i,!1,"Webcam or mic are already in use");break;case"OverconstrainedError":case"ConstraintNotSatisfiedError":u(i,!1,"Constraints can not be satisfied by avb. devices");break;case"NotAllowedError":case"PermissionDeniedError":u(i,!1,"Permission denied in browser");break;case"TypeError":u(i,!1,"Empty constraints object");break;default:u(i,!1,h)}})}}else u(i,!1,"Please start the scanner");return i}getConstraints(e=0){const o=this.video.nativeElement.srcObject,i=o&&o.getVideoTracks()[e];return i&&i.getConstraints()}download(e=`ngx_scanner_qrcode_${Date.now()}.png`,o,i){const r=new O;return(()=>{y(this,void 0,void 0,function*(){const h=((n,t)=>new File([n],t,{lastModified:(new Date).getTime(),type:n.type}))(yield fe(this.canvas.nativeElement),e);pe([h],this.config,o,i,r).subscribe(a=>{a.forEach(d=>{if(d.data&&d.data.length){const v=document.createElement("a");v.href=d.url,v.download=d.name,v.click(),v.remove()}})})})})(),r}resize(){window.addEventListener("resize",()=>{ue(this.dataForResize,this.canvas.nativeElement,this.resultsPanel.nativeElement,this.canvasStyles),ne(this.video.nativeElement,this.canvas.nativeElement)})}overrideConfig(){R(this.config,"src")&&(this.src=this.config.src),R(this.config,"fps")&&(this.fps=this.config.fps),R(this.config,"vibrate")&&(this.vibrate=this.config.vibrate),R(this.config,"decode")&&(this.decode=this.config.decode),R(this.config,"isBeep")&&(this.isBeep=this.config.isBeep),R(this.config,"constraints")&&(this.constraints=((n,t,e)=>{if(t&&Object.keys(t[n]).length){for(const o in e){const i=JSON.parse(JSON.stringify(Object.assign({},t[n],{[o]:e[o]})));t[n]=t[n].hasOwnProperty(o)?t[n]:i}return t[n]}return e})("constraints",this.config,he)),R(this.config,"canvasStyles")&&2===this.config.canvasStyles.length&&(this.canvasStyles=this.config.canvasStyles)}safariWebRTC(e,o){this.STATUS.startOFF(),this.STATUS.loadingON(),navigator.mediaDevices.getUserMedia(this.constraints).then(i=>{i.getTracks().forEach(r=>r.stop()),this.loadAllDevices(e,o)}).catch(i=>{u(e,!1,i),this.STATUS.startOFF(),this.STATUS.loadingOFF()})}loadAllDevices(e,o){navigator.mediaDevices.enumerateDevices().then(i=>{let r=i.filter(s=>"videoinput"==s.kind);this.devices.next(r),r.length>0?(u(e,r),o?o(r):this.playDevice(r[0].deviceId)):(u(e,!1,"No camera detected."),this.STATUS.startOFF(),this.STATUS.loadingOFF())}).catch(i=>{u(e,!1,i),this.STATUS.startOFF(),this.STATUS.loadingOFF()})}drawImage(e,o=(()=>{})){return y(this,void 0,void 0,function*(){const i=this.canvas.nativeElement,r=i.getContext("2d",{willReadFrequently:!0});e instanceof HTMLImageElement&&(i.width=e.naturalWidth,i.height=e.naturalHeight,e.style.visibility="",this.video.nativeElement.style.visibility="hidden",this.renderer.setStyle(this.elementRef.nativeElement,"width",i.width+"px"),this.renderer.setStyle(this.elementRef.nativeElement,"maxWidth","100%"),this.renderer.setStyle(this.elementRef.nativeElement,"display","inline-block")),e instanceof HTMLVideoElement&&(i.width=e.videoWidth,i.height=e.videoHeight,e.style.visibility="",this.canvas.nativeElement.style.visibility="hidden"),ne(this.video.nativeElement,i),r.clearRect(0,0,i.width,i.height),r.drawImage(e,0,0,i.width,i.height);const s=r.getImageData(0,0,i.width,i.height),c=yield zbarWasm.scanImageData(s);if(c&&c.length){c.forEach(a=>a.value=a.decode(this.decode&&this.decode.toLocaleLowerCase())),ue(c,Object.freeze(this.canvas.nativeElement),this.resultsPanel.nativeElement,this.canvasStyles);const h=()=>{this.eventEmit(c),this.dataForResize=c};e instanceof HTMLImageElement&&(o(!0),h(),_e(this.vibrate),te(this.isBeep)),e instanceof HTMLVideoElement&&(h(),_e(this.vibrate),te(this.isBeep))}else o(!1),me(this.resultsPanel.nativeElement),this.dataForResize=[]})}eventEmit(e=!1){!1!==e&&this.data.next(e||[]),!1!==e&&this.event.emit(e||[])}requestAnimationFrame(e=0){try{clearTimeout(this.rAF_ID),this.rAF_ID=setTimeout(()=>{this.video.nativeElement.readyState===this.video.nativeElement.HAVE_ENOUGH_DATA&&(e=0,W()&&this.drawImage(this.video.nativeElement),this.isStart&&!this.isPause&&this.requestAnimationFrame(e))},e||this.fps)}catch{clearTimeout(this.rAF_ID)}}get isReady(){return this.ready}ngOnDestroy(){this.pause()}}return n.\u0275fac=function(e){return new(e||n)(C.Y36(C.Qsj),C.Y36(C.SBq))},n.\u0275cmp=C.Xpm({type:n,selectors:[["ngx-scanner-qrcode"]],viewQuery:function(e,o){if(1&e&&(C.Gf(Ee,5),C.Gf(ye,5),C.Gf(Re,5)),2&e){let i;C.iGM(i=C.CRH())&&(o.video=i.first),C.iGM(i=C.CRH())&&(o.canvas=i.first),C.iGM(i=C.CRH())&&(o.resultsPanel=i.first)}},hostAttrs:[1,"ngx-scanner-qrcode"],inputs:{src:"src",fps:"fps",vibrate:"vibrate",decode:"decode",isBeep:"isBeep",config:"config",constraints:"constraints",canvasStyles:"canvasStyles"},outputs:{event:"event"},exportAs:["scanner"],decls:6,vars:0,consts:[[1,"origin-overlay"],["resultsPanel",""],[1,"origin-canvas"],["canvas",""],["playsinline","",1,"origin-video"],["video",""]],template:function(e,o){1&e&&C._UZ(0,"div",0,1)(2,"canvas",2,3)(4,"video",4,5)},styles:[".ngx-scanner-qrcode{display:block;position:relative}.origin-overlay{width:100%;position:absolute}.origin-overlay span{z-index:2;text-align:left;position:absolute}.origin-overlay .qrcode-polygon{z-index:1;position:absolute}.origin-canvas{width:100%;position:absolute}.origin-video{width:100%;background-color:#262626}.qrcode-tooltip{z-index:3;position:absolute}.qrcode-tooltip:hover .qrcode-tooltip-temp{display:block;position:absolute;cursor:copy}.qrcode-tooltip:hover .qrcode-tooltip-temp:active{color:#afafaf}.qrcode-tooltip .qrcode-tooltip-temp{bottom:0;left:50%;color:#fff;text-align:left;display:none;width:-moz-max-content;width:max-content;word-wrap:break-word;transform:translate(-50%);transform-style:preserve-3d;background-color:#000000d0;box-shadow:1px 1px 20px #000000e0}.qrcode-tooltip .qrcode-tooltip-temp svg{cursor:pointer}.qrcode-tooltip .qrcode-tooltip-temp svg rect{fill:none;stroke:#fff;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg path{fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg:active path,.qrcode-tooltip .qrcode-tooltip-temp svg:active rect{stroke:#afafaf}"],encapsulation:2}),n})();const l={ScannerQRCode_NONE:0,ScannerQRCode_PARTIAL:1,ScannerQRCode_EAN2:2,ScannerQRCode_EAN5:5,ScannerQRCode_EAN8:8,ScannerQRCode_UPCE:9,ScannerQRCode_ISBN10:10,ScannerQRCode_UPCA:12,ScannerQRCode_EAN13:13,ScannerQRCode_ISBN13:14,ScannerQRCode_COMPOSITE:15,ScannerQRCode_I25:25,ScannerQRCode_DATABAR:34,ScannerQRCode_DATABAR_EXP:35,ScannerQRCode_CODABAR:38,ScannerQRCode_CODE39:39,ScannerQRCode_PDF417:57,ScannerQRCode_QRCODE:64,ScannerQRCode_SQCODE:80,ScannerQRCode_CODE93:93,ScannerQRCode_CODE128:128,ScannerQRCode_SYMBOL:255,ScannerQRCode_ADDON2:512,ScannerQRCode_ADDON5:1280,ScannerQRCode_ADDON:1792};l[l.ScannerQRCode_NONE]="ScannerQRCode_NONE",l[l.ScannerQRCode_PARTIAL]="ScannerQRCode_PARTIAL",l[l.ScannerQRCode_EAN2]="ScannerQRCode_EAN2",l[l.ScannerQRCode_EAN5]="ScannerQRCode_EAN5",l[l.ScannerQRCode_EAN8]="ScannerQRCode_EAN8",l[l.ScannerQRCode_UPCE]="ScannerQRCode_UPCE",l[l.ScannerQRCode_ISBN10]="ScannerQRCode_ISBN10",l[l.ScannerQRCode_UPCA]="ScannerQRCode_UPCA",l[l.ScannerQRCode_EAN13]="ScannerQRCode_EAN13",l[l.ScannerQRCode_ISBN13]="ScannerQRCode_ISBN13",l[l.ScannerQRCode_COMPOSITE]="ScannerQRCode_COMPOSITE",l[l.ScannerQRCode_I25]="ScannerQRCode_I25",l[l.ScannerQRCode_DATABAR]="ScannerQRCode_DATABAR",l[l.ScannerQRCode_DATABAR_EXP]="ScannerQRCode_DATABAR_EXP",l[l.ScannerQRCode_CODABAR]="ScannerQRCode_CODABAR",l[l.ScannerQRCode_CODE39]="ScannerQRCode_CODE39",l[l.ScannerQRCode_PDF417]="ScannerQRCode_PDF417",l[l.ScannerQRCode_QRCODE]="ScannerQRCode_QRCODE",l[l.ScannerQRCode_SQCODE]="ScannerQRCode_SQCODE",l[l.ScannerQRCode_CODE93]="ScannerQRCode_CODE93",l[l.ScannerQRCode_CODE128]="ScannerQRCode_CODE128",l[l.ScannerQRCode_SYMBOL]="ScannerQRCode_SYMBOL",l[l.ScannerQRCode_ADDON2]="ScannerQRCode_ADDON2",l[l.ScannerQRCode_ADDON5]="ScannerQRCode_ADDON5",l[l.ScannerQRCode_ADDON]="ScannerQRCode_ADDON";const A={ScannerQRCode_CFG_ENABLE:0,ScannerQRCode_CFG_ADD_CHECK:1,ScannerQRCode_CFG_EMIT_CHECK:2,ScannerQRCode_CFG_ASCII:3,ScannerQRCode_CFG_BINARY:4,ScannerQRCode_CFG_NUM:5,ScannerQRCode_CFG_MIN_LEN:32,ScannerQRCode_CFG_MAX_LEN:33,ScannerQRCode_CFG_UNCERTAINTY:64,ScannerQRCode_CFG_POSITION:128,ScannerQRCode_CFG_TEST_INVERTED:129,ScannerQRCode_CFG_X_DENSITY:256,ScannerQRCode_CFG_Y_DENSITY:257};A[A.ScannerQRCode_CFG_ENABLE]="ScannerQRCode_CFG_ENABLE",A[A.ScannerQRCode_CFG_ADD_CHECK]="ScannerQRCode_CFG_ADD_CHECK",A[A.ScannerQRCode_CFG_EMIT_CHECK]="ScannerQRCode_CFG_EMIT_CHECK",A[A.ScannerQRCode_CFG_ASCII]="ScannerQRCode_CFG_ASCII",A[A.ScannerQRCode_CFG_BINARY]="ScannerQRCode_CFG_BINARY",A[A.ScannerQRCode_CFG_NUM]="ScannerQRCode_CFG_NUM",A[A.ScannerQRCode_CFG_MIN_LEN]="ScannerQRCode_CFG_MIN_LEN",A[A.ScannerQRCode_CFG_MAX_LEN]="ScannerQRCode_CFG_MAX_LEN",A[A.ScannerQRCode_CFG_UNCERTAINTY]="ScannerQRCode_CFG_UNCERTAINTY",A[A.ScannerQRCode_CFG_POSITION]="ScannerQRCode_CFG_POSITION",A[A.ScannerQRCode_CFG_TEST_INVERTED]="ScannerQRCode_CFG_TEST_INVERTED",A[A.ScannerQRCode_CFG_X_DENSITY]="ScannerQRCode_CFG_X_DENSITY",A[A.ScannerQRCode_CFG_Y_DENSITY]="ScannerQRCode_CFG_Y_DENSITY";const Q={ScannerQRCode_ORIENT_UNKNOWN:-1,ScannerQRCode_ORIENT_UP:0,ScannerQRCode_ORIENT_RIGHT:1,ScannerQRCode_ORIENT_DOWN:2,ScannerQRCode_ORIENT_LEFT:3};Q[Q.ScannerQRCode_ORIENT_UNKNOWN]="ScannerQRCode_ORIENT_UNKNOWN",Q[Q.ScannerQRCode_ORIENT_UP]="ScannerQRCode_ORIENT_UP",Q[Q.ScannerQRCode_ORIENT_RIGHT]="ScannerQRCode_ORIENT_RIGHT",Q[Q.ScannerQRCode_ORIENT_DOWN]="ScannerQRCode_ORIENT_DOWN",Q[Q.ScannerQRCode_ORIENT_LEFT]="ScannerQRCode_ORIENT_LEFT";let Me=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=C.oAB({type:n}),n.\u0275inj=C.cJS({providers:[b]}),n})()}}]);